<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
  <meta name="robots" content="noindex, nofollow">
  <title>STAMP</title>
  <style>
  *{margin: 0; padding: 0;}
  .wrapper{
    width: 320px;
    height: 800px;
    overflow: hidden;
  }
  #canvasEdit{ width: 320px;}
  #result{
    width: 320px;
    border: 1px solid #000;
    -webkit-box-sizing: border-box;
       -moz-box-sizing: border-box;
            box-sizing: border-box;
  }
  .visibility-none{
    margin-left: 400px;
  }
  </style>


</head>

<body>
  <!-- #content -->
  <div id="content">

    <!-- .wrapper -->
    <div class="wrapper" id="stamp">

      <!-- #edit -->
      <div id="edit">
        <div class="stamp__preview">
          <canvas id="canvasEdit"></canvas>
        </div>
        ↓は画像<br>
        <img src="" alt="" id="result">
      </div>
      <!-- //#edit -->

      <div class="visibility-none">
        <img src="icons.png" alt="">
      </div>
    </div>
    <!-- //.wrapper -->

  </div>
  <!-- //#content -->


<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="../js/jquery.min.js"><\/script>')</script>
<script>
$(function(){
  var s = 1; //倍率

  $(window).load(function(){
    drewImage();
  })

  // canvasから画像合成
  function drewImage(){
    var canvas = document.getElementById("canvasEdit");
    canvas.width = 640;
    canvas.height = 640;
    var ctx = canvas.getContext("2d");
    var img = new Image();
    img.src = './000.png';
    var spriteImg = new Image();
    spriteImg.src = './icons.png'
    img.onload = function(){

      // ベースとなる領域
      ctx.beginPath();
      var canvasPattern = ctx.createPattern(img, 'no-repeat');
      ctx.fillStyle = canvasPattern;
      ctx.rect(0, 0, 640, 640);
      ctx.fill();


      // 合成する画像
      // var icon1 = ctx.createPattern(spriteImg, "no-repeat");
      // ctx.fillStyle = icon1;
      // ctx.fillRect(30, 40, 80, 80);
      ctx.drawImage(spriteImg, 30, 40, 80, 80, 10, 10, 80, 80);
      ctx.drawImage(spriteImg, 250, 40, 80, 80, 90, 100, 80, 80);
      ctx.drawImage(spriteImg, 140, 150, 80, 80, 300, 400, 80, 80);
      ctx.drawImage(spriteImg, 580, 260, 80, 80, 560, 0, 80, 80);


      var img_png_src = canvas.toDataURL();
      $('#result').attr('src', img_png_src);
    };

  }


});

</script>
</body>
</html>